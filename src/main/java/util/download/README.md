# 下载工具类说明

实现一个下载工具类，支持以下功能：

备注：仅支持`http`和`https`（暂不支持SSL证书）协议的链接，仅支持做`SDK`

该包可以独立成为一个下载工具类

> 可以自定义请求头
>
> 可以自动重试下载（重试次数手动规定）
>
> 可以规避错误的链接（响应码大于400，或者URL错误，DNS错误）
>
> 可以回调显示实时速度
>
> 可以在下载结束后回调获得下载速度平均值
>
> 可以显示实时下载进度
>
> 可以下载流式链接
>
> 可以支持断点续传
>
> 可以选择多线程和单线程
>
> 如果没有规定文件名则默认获取文件名
>
> 如果没有规定下载路径，则默认是用户目录下的下载路径



# 解释说明

+ 可以自定义请求头

  这个只需要传递一个`Map`对象即可

+ 可以自动重试下载

  需要再全局规定一个重试次数，然后当下载出现异常的时候自动按照这个次数递归

+ 可以规避错误的链接

  第一种是响应码大于400的，第二种是`DNS`解析异常的，还有断网的，还有很多情况，最终要达到的结果是无论如何都不能出现异常，所有的异常全部靠回调

+ 可以支持断点续传

  专门实现一个断点续传的工具类

  要注意的地方很多，比如说一个文件使用了两个链接，第一个链接下载了一半，停了程序，然后第二个链接又接着第一个链接开始下载了，这种情况显然不可取，所以要使用URL来做文件的唯一ID

  再比如，断点续传需要使用文件专门记录断点，但是有一种情况，文件不在了，断点文件还在，那么这个时候就要做出判断，提高程序的健壮性

+ 多线程和单线程

  无论是多线程还是单线程，都必须实现完全一样的功能

+ 自动获取文件名

  根据不同的情况获取不同的文件名，要拥有谷歌浏览器那样的文件名处理机制

```reStructuredText
目前支持下载下列的情况:
正常的地址，例如：https://dldir1.qq.com/qqfile/qq/PCQQ9.1.5/25530/QQ9.1.5.25530.exe
如果地址异常：https://dldir1.qq.com/qqfile/qq/PCQQ9.1.5/25530/QQ9.1.5.25530.none 则会回调下载出错
如果地址不存在：http://www.xxxxxxxxx.cn 则会回调下载错误，错误响应码为-1
如果地址没有协议，www.baidu.com 则会回调下载错误，错误响应码为-1
直播流或响应流，例如：
https://github.com/CodeLunatic/question/archive/master.zip 此时虽然contentLength没有长度，但是依然下载
(注意这里的直播流或响应流下载每次会重新创建文件，如果不需要重新创建文件请调用downloadAppendToFile())
```